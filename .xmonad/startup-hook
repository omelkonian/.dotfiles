#!/bin/bash

function start {
    if [ -z "$(pgrep $1)" ] ; then
        $1 &
    fi
}
if [ -z "$(pgrep nm-applet)" ] ; then
    nm-applet --sm-disable &
fi
if [ -z "$(pgrep synapse)" ] ; then
    synapse -s &
fi
# start "skype"
start "thunderbird"
# start "/home/orestis/.dropbox-dist/dropboxd"
start "dropbox"
echo "Apps started"


if [ "$(hostname)" == "omelkonian-XPS-15-9560" ]; then
    # Dell
    HDMI="HDMI1"
    BUILTIN="eDP1"
else
    # HP
    HDMI="HDMI1"
    BUILTIN="LVDS1"
fi
echo "Laptop variables set"


if [ -n "$(xrandr | grep $HDMI | grep " connected ")" ]; then
    # Docked
    xrandr --output $BUILTIN --off --output $HDMI --auto
else
    # Undocked
    xrandr --output $BUILTIN --auto
fi
echo "Monitors configured"

if [ -n "$(pgrep trayer)" ] ; then
    kill $(pgrep trayer)
fi
# trayer --edge top --monitor primary --align right --SetDockType true --SetPartialStrut true --expand true --width 15 --height 12 --transparent true --tint 0x000000 &
trayer --edge top --align right --monitor primary --widthtype percent --width 10 --height 24 --transparent true --alpha 0 --tint 0x000000 &
echo "Icon tray spawned"

nitrogen --set-auto ~/Wallpapers/discontinuous_plains.jpg
echo "Wallpaper set"

source ~/.zshrc
echo "ZSH run"
